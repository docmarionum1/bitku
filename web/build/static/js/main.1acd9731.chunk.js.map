{"version":3,"sources":["config.js","cadence/scripts.js","hooks/useCurrentUser.js","components/AuthCluster.js","cadence/transactions.js","components/Mint.js","components/Haikus.js","App.js","reportWebVitals.js","index.js"],"names":["console","log","process","config","put","FEATURED_ADDRESS","contract_address","GET_NEXT_ID_AND_PRICE","getNextIDAndPrice","a","fcl","then","response","id","Object","keys","parseInt","price","GET_HAIKUS","getHaikus","haikus","t","key","value","getBalance","user","addr","getUserHaikus","UserStateContext","React","createContext","UserStateProvider","children","useState","balance","setBalance","userHaikus","setUserHaikus","Provider","useCurrentUser","loggedIn","setUser","useContext","useEffect","subscribe","updateBalance","useCallback","useStyles","makeStyles","theme","root","display","justifyContent","padding","spacing","button","AuthCluster","classes","menuAnchor","setMenuAnchor","handleClose","className","Fragment","Button","variant","onClick","event","currentTarget","Menu","anchorEl","keepMounted","open","onClose","MenuItem","disabled","MINT_HAIKU_TRANSACTION","mintHaikuTransaction","nextHaiku","txId","onceSealed","height","flexDirection","Mint","setError","setNextHaiku","loading","setLoading","haiku","setHaiku","fetch","mintHaiku","window","scrollTo","text","Typography","typing","fixed","marginBottom","paper","borderRadius","skeletonContainer","flexGrow","skeleton","margin","Haikus","heading","order","ids","Grid","container","map","item","xs","sm","md","lg","Paper","elevation","Skeleton","animation","width","createMuiTheme","typography","fontFamily","join","h6","textAlign","textDecoration","fontSize","fontWeight","h4","body2","whiteSpace","shape","App","error","snackbarOpen","setSnackbarOpen","typingEnd","setTypingEnd","featuredAddress","featuredIds","featuredHaikus","setFeaturedHaikus","handleErrorClose","requestedHaikus","push","getText","CssBaseline","ThemeProvider","Container","onTypingEnd","Snackbar","autoHideDuration","Alert","severity","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.1acd9731.chunk.js","sourcesContent":["import {config} from \"@onflow/fcl\"\n\nconsole.log(process.env);\n\nconfig()\n  .put(\"accessNode.api\", process.env.REACT_APP_ACCESS_NODE) // Configure FCL's Access Node\n  .put(\"challenge.handshake\", process.env.REACT_APP_WALLET_DISCOVERY) // Configure FCL's Wallet Discovery mechanism\n  //.put(\"0xProfile\", process.env.REACT_APP_CONTRACT_PROFILE) // Will let us use `0xProfile` in our Cadence\n\nexport let FEATURED_ADDRESS = \"\";\n  \n  \nif (process.env.REACT_APP_FLOW_NETWORK === \"emulator\") {\n  const contract_address = \"0xf8d6e0586b0a20c7\";\n  config()\n    .put(\"0xFUNGIBLETOKENADDRESS\", \"0xee82856bf20e2aa6\")\n    .put(\"0xTOKENADDRESS\", \"0x0ae53cb6e3f42a79\")\n    .put(\"0xNONFUNGIBLETOKENADDRESS\", contract_address)\n    .put(\"0xHAIKUNFTADDRESS\", contract_address);\n\n  FEATURED_ADDRESS = contract_address;\n\n  FEATURED_ADDRESS = \"0xf8d6e0586b0a20c7\";\n} else if (process.env.REACT_APP_FLOW_NETWORK === \"testnet\") {\n  const contract_address = \"0x15032505846acdad\";\n  config()\n    .put(\"0xFUNGIBLETOKENADDRESS\", \"0x9a0766d93b6608b7\")\n    .put(\"0xTOKENADDRESS\", \"0x7e60df042a9c0868\")\n    .put(\"0xNONFUNGIBLETOKENADDRESS\", \"0x631e88ae7f1d7c20\")\n    .put(\"0xHAIKUNFTADDRESS\", contract_address);\n\n  FEATURED_ADDRESS = contract_address;\n}\n","import * as fcl from \"@onflow/fcl\";\nimport * as t from \"@onflow/types\";\n\nexport const GET_NEXT_ID_AND_PRICE = `\nimport HaikuNFT from 0xHAIKUNFTADDRESS\n\npub fun main(): {UInt64: UFix64} {\n\n    return {HaikuNFT.totalSupply: HaikuNFT.currentPrice()}\n}\n`;\n\nexport async function getNextIDAndPrice() {\n  const response = await fcl\n  .send([\n    fcl.script(GET_NEXT_ID_AND_PRICE)\n  ])\n  .then(fcl.decode);\n\n  const id = Object.keys(response)[0];\n  return {\n    id: parseInt(id),\n    price: response[id]\n  };\n}\n\nexport const GET_HAIKU = `\nimport HaikuNFT from 0xHAIKUNFTADDRESS\nimport NonFungibleToken from 0xNONFUNGIBLETOKENADDRESS\n\npub fun main(id: UInt64, address: Address): String {\n  let account = getAccount(address)\n  let capability = account.getCapability(/public/HaikuCollection)\n  let ref = capability.borrow<&{HaikuNFT.HaikuCollectionPublic, NonFungibleToken.CollectionPublic}>() ?? panic(\"Could not borrow\")\n\n  return ref.borrowHaiku(id: id).text\n}\n`;\n\nexport const GET_HAIKUS = `\nimport HaikuNFT from 0xHAIKUNFTADDRESS\nimport NonFungibleToken from 0xNONFUNGIBLETOKENADDRESS\n\npub fun main(haikus: { UInt64: Address }): { UInt64: String } {\n  let response: {UInt64: String} = {}\n  for id in haikus.keys {\n    let address = haikus[id]!\n    let account = getAccount(address)\n    let capability = account.getCapability(/public/HaikuCollection)\n    let ref = capability.borrow<&{HaikuNFT.HaikuCollectionPublic, NonFungibleToken.CollectionPublic}>() ?? panic(\"Could not borrow\")\n    response[id] = ref.borrowHaiku(id: id).text\n  }\n\n  //return ref.borrowHaiku(id: id).text\n  return response\n}\n`;\n\nexport async function getHaikus(haikus) {\n  return await fcl\n    .send([\n      fcl.script(GET_HAIKUS),\n      fcl.args([\n        fcl.arg(haikus, t.Dictionary({key: t.UInt64, value: t.Address}))\n        //fcl.arg(address, t.Address),\n        //fcl.arg(id, t.UInt64),\n      ]),\n    ])\n    .then(fcl.decode);\n}\n\nexport async function getBalance(user) {\n  return await fcl\n  .send([\n    fcl.script`\n      import FungibleToken from 0xFUNGIBLETOKENADDRESS\n      import FlowToken from 0xTOKENADDRESS\n      \n      pub fun main(account: Address): UFix64 {\n      \n          let vaultRef = getAccount(account)\n              .getCapability(/public/flowTokenBalance)\n              .borrow<&FlowToken.Vault{FungibleToken.Balance}>()\n              ?? panic(\"Could not borrow Balance reference to the Vault\")\n      \n          return vaultRef.balance\n          \n          \n          //return getAccount(account).balance\n      }\n    `,\n    fcl.args([\n      fcl.arg(user.addr, t.Address), // <-- t.Address this time :)\n    ]),\n  ])\n  .then(fcl.decode);\n}\n\nexport async function getUserHaikus(user) {\n  return await fcl\n  .send([\n    fcl.script`\n      import HaikuNFT from 0xHAIKUNFTADDRESS\n      import NonFungibleToken from 0xNONFUNGIBLETOKENADDRESS\n      \n      pub fun main(address: Address): {UInt64: String} {\n        let account = getAccount(address)\n        let capability = account.getCapability(/public/HaikuCollection)\n        let ref = capability.borrow<&{HaikuNFT.HaikuCollectionPublic, NonFungibleToken.CollectionPublic}>() ?? panic(\"Could not borrow\")\n      \n        let haikus: {UInt64: String} = {}\n      \n        for id in ref.getIDs() {\n          let nft = ref.borrowNFT(id: id)\n          haikus[id] = ref.borrowHaiku(id: id).text\n        }\n      \n        return haikus\n      }\n    `,\n    fcl.args([\n      fcl.arg(user.addr, t.Address), // <-- t.Address this time :)\n    ]),\n  ])\n  .then(fcl.decode);\n}","import React, {useCallback, useEffect, useState, useContext} from \"react\";\nimport * as fcl from \"@onflow/fcl\";\nimport {getBalance, getUserHaikus} from \"../cadence/scripts\";\n\nconst UserStateContext = React.createContext();\n\nexport function UserStateProvider({children}) {\n  const [balance, setBalance] = useState(0);\n  const [userHaikus, setUserHaikus] = useState({});\n\n  return <UserStateContext.Provider value={{balance, setBalance, userHaikus, setUserHaikus}} children={children} />\n}\n\nexport function useCurrentUser() {\n  const [user, setUser] = useState({loggedIn: null});\n  const {balance, setBalance, userHaikus, setUserHaikus} = useContext(UserStateContext);\n\n  useEffect(() => fcl.currentUser().subscribe(setUser), []);\n\n  const updateBalance = useCallback(async () => {\n    const balance = await getBalance(user);\n    setBalance(balance);\n  }, [user]);\n\n  useEffect(() => {\n    if (user.loggedIn)  {\n      updateBalance();\n    } else {\n      setBalance(0);\n    }\n  }, [user]);\n\n  useEffect(() => {\n    async function getHaikus() {\n      try {\n        const haikus = await getUserHaikus(user);\n        setUserHaikus(haikus);\n      } catch {}\n    }\n\n    if (user.loggedIn) {\n      getHaikus();\n    } else {\n      setUserHaikus({});\n    }\n  }, [user]);\n  \n  return {user, balance, updateBalance, userHaikus, setUserHaikus};\n}\n\nexport default useCurrentUser;","// File: ./src/auth-cluster.js\n\nimport React, {useState, useEffect} from \"react\"\nimport * as fcl from \"@onflow/fcl\"\nimport Button from '@material-ui/core/Button';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Menu from '@material-ui/core/Menu';\nimport MenuItem from '@material-ui/core/MenuItem';\n\nimport useCurrentUser from \"../hooks/useCurrentUser\";\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    // position: \"absolute\",\n    // top: theme.spacing(1),\n    // right: theme.spacing(1)\n    display: \"flex\",\n    justifyContent: \"flex-end\",\n    padding: theme.spacing(1)\n  },\n  button: {\n    \n  }\n}))\n\nexport function AuthCluster() {\n  const classes = useStyles();\n  const {user, balance} = useCurrentUser();\n  const [menuAnchor, setMenuAnchor] = useState(null);\n\n  const handleClose = () => {\n    setMenuAnchor(null);\n  }\n\n  return (\n    <div className={classes.root}>\n      {user.loggedIn ?\n        <React.Fragment>\n          <div>\n            <Button variant=\"outlined\" onClick={(event) => {setMenuAnchor(event.currentTarget)}}>{user.addr}</Button>\n          </div> \n          <Menu\n            anchorEl={menuAnchor}\n            keepMounted\n            open={!!menuAnchor}\n            onClose={handleClose}\n          >\n            <MenuItem disabled>₣{balance} FLOW</MenuItem>\n            <MenuItem onClick={() => {\n              handleClose();\n              fcl.unauthenticate();\n            }}>Log Out</MenuItem>\n          </Menu>\n        </React.Fragment> :\n        <div>\n          <Button variant=\"outlined\" onClick={fcl.logIn}>Connect Wallet</Button>\n        </div>\n        }\n    </div>\n  );\n\n  if (user.loggedIn) {\n    return (\n      <div>\n        <span>{user?.addr ?? \"No Address\"}</span>\n        <span>₣{balance} FLOW</span>\n        <Button onClick={fcl.unauthenticate}>Log Out</Button>\n      </div>\n    )\n  } else {\n    return (\n      <div>\n        <Button onClick={fcl.logIn}>Log In</Button>\n      </div>\n    )\n  }\n}\n\nexport default AuthCluster;","import * as fcl from \"@onflow/fcl\"\nimport * as t from \"@onflow/types\";\n\nexport const MINT_HAIKU_TRANSACTION = `\nimport FungibleToken from 0xFUNGIBLETOKENADDRESS\nimport FlowToken from 0xTOKENADDRESS\nimport NonFungibleToken from 0xNONFUNGIBLETOKENADDRESS\n\nimport HaikuNFT from 0xHAIKUNFTADDRESS\n\ntransaction (haikuID: UInt64, price: UFix64) {\n    let collection: &NonFungibleToken.Collection\n    let sentVault: @FungibleToken.Vault\n    \n    prepare(signer: AuthAccount) {\n        // if the account doesn't already have a collection\n        if signer.borrow<&HaikuNFT.Collection>(from: /storage/HaikuCollection) == nil {\n\n\n            // create a new empty collection\n            let collection <- HaikuNFT.createEmptyCollection()\n            \n            // save it to the account\n            signer.save(<-collection, to: /storage/HaikuCollection)\n\n            // create a public capability for the collection\n            signer.link<&{NonFungibleToken.CollectionPublic, HaikuNFT.HaikuCollectionPublic}>(/public/HaikuCollection, target: /storage/HaikuCollection)\n        }\n\n        self.collection = signer.borrow<&NonFungibleToken.Collection>(from: /storage/HaikuCollection) \n             ?? panic(\"Could not borrow reference to NFT Collection!\")\n\n        // Get a reference to the signer's stored vault\n        let vaultRef = signer.borrow<&FlowToken.Vault>(from: /storage/flowTokenVault)\n          ?? panic(\"Could not borrow reference to the owner's Vault!\")\n\n        // Withdraw tokens from the signer's stored vault\n        self.sentVault <- vaultRef.withdraw(amount: price)\n    }\n\n    execute {\n        HaikuNFT.mintHaiku(recipient: self.collection, vault: <- self.sentVault, id: haikuID)\n    }\n}\n`;\n\nexport async function mintHaikuTransaction(nextHaiku) {\n  const txId = await fcl.send([\n    fcl.transaction(MINT_HAIKU_TRANSACTION),\n    fcl.args([\n      fcl.arg(nextHaiku.id, t.UInt64),\n      fcl.arg(nextHaiku.price, t.UFix64),\n    ]),\n    fcl.payer(fcl.authz), // current user is responsible for paying for the transaction\n    fcl.proposer(fcl.authz), // current user acting as the nonce\n    fcl.authorizations([fcl.authz]), // current user will be first AuthAccount\n    fcl.limit(9999), // set the compute limit\n  ])\n  .then(fcl.decode);\n\n  return fcl.tx(txId).onceSealed();\n}","import React, {useState, useEffect, useCallback} from \"react\"\n\nimport Button from '@material-ui/core/Button';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles } from '@material-ui/core/styles';\nimport TypeWriter from 'react-typewriter';\n\n\nimport {getHaikus, getNextIDAndPrice} from \"../cadence/scripts\";\nimport {mintHaikuTransaction} from \"../cadence/transactions\";\nimport useCurrentUser from \"../hooks/useCurrentUser\";\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: \"20rem\",\n    display: \"flex\",\n    flexDirection: \"column\",\n    justifyContent: \"space-evenly\"\n  }\n}));\n\nexport function Mint({setError}) {\n  const classes = useStyles();\n\n  const [nextHaiku, setNextHaiku] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [haiku, setHaiku] = useState(null);\n  const {user, updateBalance, setUserHaikus} = useCurrentUser();\n\n  useEffect(() => {\n    async function fetch() {\n      setLoading(true);\n      setNextHaiku(await getNextIDAndPrice());\n      setLoading(false);\n    }\n\n    if (nextHaiku === null) {\n      fetch();\n    }\n  }, [nextHaiku]);\n\n  useEffect(() => {\n    if (!user.loggedIn) {\n      setHaiku(null);\n    }\n  }, [user]);\n\n  const mintHaiku = useCallback(async () => {\n    setLoading(true);\n    try {\n      // Mint the new haiku and get the text\n      await mintHaikuTransaction(nextHaiku);\n      window.scrollTo(0, 0);\n      const response = await getHaikus({key: nextHaiku.id, value: user.addr});\n      const text = response[Object.keys(response)[0]];\n\n      // Update the newly minted haiku component\n      setHaiku({\n        id: nextHaiku.id,\n        text: text,\n      });\n\n      // Add it to the user's list of haiku\n      setUserHaikus((haikus) => {\n        return {...haikus, [nextHaiku.id]: text};\n      });\n\n      setNextHaiku(null);\n      updateBalance();\n    } catch (e) {\n      if (e !== \"Declined: Externally Halted\") {\n        setError(e);\n      }\n      setNextHaiku(null);\n    }\n  }, [user, nextHaiku])\n\n  if (loading) {\n    return (\n      <div className=\"spinner\" id=\"spinner\">\n        <div className=\"double-bounce1\"></div>\n        <div className=\"double-bounce2\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className={classes.root}>\n      {haiku &&\n        <div>\n          <Typography variant=\"h6\">{haiku.id}</Typography>\n          <Typography variant=\"body2\"><TypeWriter typing={1} fixed={true}>{haiku.text}</TypeWriter></Typography>\n        </div>\n      }\n      <div>\n        <Button variant=\"outlined\" disabled={!user.loggedIn || nextHaiku === null} onClick={mintHaiku}>\n            Mint Bitku #{nextHaiku.id}/1024 (₣{nextHaiku.price} FLOW)\n        </Button>\n      </div>\n    </div>\n  );\n}\n\nexport default Mint;","import React, {useState, useEffect} from \"react\"\n\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { Paper } from \"@material-ui/core\";\nimport Grid from '@material-ui/core/Grid';\nimport Skeleton from '@material-ui/lab/Skeleton';\n\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    marginBottom: theme.spacing(4)\n  },\n  paper: {\n    //width: \"fit-content\",\n    padding: theme.spacing(2),\n    borderRadius: theme.spacing(.5),\n    height: '12em',\n    display: \"flex\",\n    flexDirection: \"column\",\n  },\n  skeletonContainer: {\n    display: \"flex\",\n    flexDirection: \"column\",\n    flexGrow: 1,\n    justifyContent: \"center\"\n  },\n  skeleton: {\n    margin: \"auto\"\n  }\n}));\n\nexport function Haikus ({haikus, heading, order}) {\n  const classes = useStyles();\n\n  const ids = order ? order : Object.keys(haikus);\n\n  return (\n    <div className={classes.root}>\n      <Typography variant=\"h4\">{heading}</Typography>\n      <Grid container spacing={3}>\n        {haikus && ids.map((id) => (\n          <Grid item xs={12} sm={6} md={6} lg={4} key={id}>\n            <Paper elevation={3} className={classes.paper}>\n              <Typography variant=\"h6\">{id}</Typography>\n              {\n                haikus[id] ? \n                <Typography variant=\"body2\">{haikus[id]}</Typography> :\n                <div className={classes.skeletonContainer}>\n                  <div>\n\n                    <Skeleton variant=\"text\" animation=\"wave\" width=\"40%\" className={classes.skeleton}/>\n                    <Skeleton variant=\"text\" animation=\"wave\" width=\"56%\" className={classes.skeleton}/>\n                    <Skeleton variant=\"text\" animation=\"wave\" width=\"40%\" className={classes.skeleton}/>\n                  </div>\n                </div>\n              }\n            </Paper>\n          </Grid>\n        ))}\n      </Grid>\n    </div>\n  );\n}\n\nexport default Haikus;","import React, {useState, useEffect} from \"react\";\nimport './App.css';\n\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport { createMuiTheme, ThemeProvider, makeStyles } from '@material-ui/core/styles';\nimport Snackbar from '@material-ui/core/Snackbar';\nimport Alert from '@material-ui/lab/Alert';\nimport { Typography } from \"@material-ui/core\";\nimport Container from '@material-ui/core/Container';\nimport TypeWriter from 'react-typewriter';\n\n\n\nimport {useCurrentUser} from \"./hooks/useCurrentUser\";\nimport AuthCluster from \"./components/AuthCluster\";\nimport Mint from './components/Mint';\nimport Haikus from './components/Haikus';\nimport {getHaikus} from './cadence/scripts';\nimport { FEATURED_ADDRESS } from \"./config\";\n\nconst theme = createMuiTheme({\n  typography: {\n    fontFamily: [\n      '\"Courier New\"',\n      'courier',\n      'monospace'\n    ].join(','),\n    h6: {\n      textAlign: \"center\",\n      textDecoration: \"underline\",\n      fontSize: \"1rem\",\n      fontWeight: \"bold\"\n    },\n    h4: {\n      marginBottom: \"1rem\",\n      textDecoration: \"underline\"\n    },\n    body2: {\n      textAlign: \"center\",\n      whiteSpace: \"pre\",\n      flexGrow: 1,\n      display: \"flex\",\n      flexDirection: \"column\",\n      justifyContent: \"center\",\n    }\n  },\n  shape: {\n    borderRadius: 32\n  }\n});\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    textAlign: \"center\"\n  },\n}));\n\n\nfunction App() {\n  const classes = useStyles();\n  const [error, setError] = useState(null);\n  const [snackbarOpen, setSnackbarOpen] = useState(false);\n  const [typingEnd, setTypingEnd] = useState(false);\n  const {userHaikus} = useCurrentUser();\n  const featuredAddress = FEATURED_ADDRESS;\n  const featuredIds = [40, 29, 0, 4, 5, 28, 41, 62];\n  const [featuredHaikus, setFeaturedHaikus] = useState({});\n\n  const handleErrorClose = () => setSnackbarOpen(false);\n\n  useEffect(() => {\n    if (error !== null) {\n      setSnackbarOpen(true);\n    }\n  }, [error]);\n\n  useEffect(() => {\n    async function getText() {\n      const requestedHaikus = [];\n      for (const id of featuredIds) {\n        requestedHaikus.push({key: id, value: featuredAddress});\n      }\n\n      setFeaturedHaikus(await getHaikus(requestedHaikus));\n    }\n\n    getText();\n  }, []);\n\n  return (\n    <React.Fragment>\n      <CssBaseline/>\n      <ThemeProvider theme={theme}>\n        <div className={classes.root}>\n          <AuthCluster/>\n          <Container>\n            <Typography variant=\"h1\">\n              <TypeWriter \n                typing={1}\n                onTypingEnd={() => setTypingEnd(true)}\n              >\n                Bitku\n              </TypeWriter>\n            </Typography>\n            {typingEnd &&\n              <React.Fragment>\n                <Mint setError={setError}/>\n                <Haikus haikus={featuredHaikus} order={featuredIds} heading=\"Featured\"/>\n                <Haikus haikus={userHaikus} heading=\"My Bitku\"/>\n              </React.Fragment>\n            }\n            <Snackbar open={snackbarOpen} autoHideDuration={10000} onClose={handleErrorClose}>\n              <Alert onClose={handleErrorClose} severity=\"error\">\n                {error}\n              </Alert>\n            </Snackbar>\n          </Container>\n        </div>\n      </ThemeProvider>\n    </React.Fragment>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import \"./config\"\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport {UserStateProvider} from \"./hooks/useCurrentUser\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <UserStateProvider>\n      <App />\n    </UserStateProvider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}